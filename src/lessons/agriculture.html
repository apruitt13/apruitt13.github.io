<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Drone Education App</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .blocklyFlyoutScrollbar.blocklyScrollbarVertical {
            display: none;
        }

        /* For WebKit browsers (Chrome, Safari) */
        .blocklyFlyoutScrollbar.blocklyScrollbarVertical::-webkit-scrollbar {
            display: none;
        }
        /* Custom styles to ensure Blockly and canvas fill their containers */
        #blocklyDiv, #simulationCanvas {
            width: 100%;
            height: 100%;
            display: block;
        }
        #blocklyContainer, #simulationContainer {
            height: 60vh; /* Adjust height for better fit */
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            overflow: hidden;
            background-color: #f9fafb;
        }
        /* --- FIX: Create a new stacking context for Blockly --- */
        #blocklyContainer {
            position: relative;
            z-index: 0;
        }
        .scrollable-content {
            height: 100%;
            overflow-y: auto;
        }
    /* Force smaller drone media size */
        #droneMediaWrapper img,
        #droneMediaWrapper video {
            width: 150px !important;
            height: 100px !important;
            object-fit: contain;
            display: block;
        }
        #droneMediaWrapper video {
            margin-bottom: 0 !important;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans p-6">

    <!-- Navigation Menu -->
    <nav class="bg-white shadow-lg rounded-full px-6 py-3 mb-6 flex justify-center space-x-4">
        <a href="../index.html" class="text-gray-700 font-semibold hover:text-blue-600 transition-colors duration-200">Home</a>
        <div class="relative">
            <button id="lessons-button" class="text-gray-700 font-semibold hover:text-blue-600 transition-colors duration-200 focus:outline-none">
                Lessons
            </button>
            <div id="lessons-dropdown" class="absolute hidden bg-white shadow-lg rounded-xl p-2 w-48 mt-2 z-10">
                <a href="agriculture.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Agriculture</a>
                <a href="construction.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Construction</a>
                <a href="realEstate.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Real Estate</a>
                <a href="filmMaking.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Filmmaking</a>
                <a href="publicSafety.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Public Safety</a>
                <a href="surveyingMapping.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Surveying and Mapping</a>
                <a href="energyUtilities.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Energy and Utilities</a>
                <a href="logisticsDelivery.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Logistics and Delivery</a>
                <a href="journalism.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Journalism</a>
                <a href="environmentalConservation.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Environmental Conservation</a>
            </div>
        </div>
        <div class="relative">
            <button id="part107-button" class="text-gray-700 font-semibold hover:text-blue-600 transition-colors duration-200 focus:outline-none">
                Part 107 Study Guide
            </button>
            <div id="part107-dropdown" class="absolute hidden bg-white shadow-lg rounded-xl p-2 w-48 mt-2 z-10">
                <a href="/part107/part107.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Introduction</a>
            </div>
        </div>
    </nav>

    <!-- Main container for the 3-column layout -->
    <div class="flex flex-col lg:flex-row gap-6">

        <!-- Column 1: Drone Information -->
        <div class="flex-1 bg-white shadow-lg rounded-xl p-6 max-h-[80vh] flex flex-col">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">The Role of Drones in Agriculture</h2>
            <div class="h-full overflow-y-auto">
                <p class="mb-4">
                    In modern farming, drones are essential tools for a practice called precision agriculture. Instead of relying on guesswork, 
                    farmers can use drones to collect detailed data about their fields.
                </p>

                <ul class="list-disc list-inside space-y-1 mb-4">
                    <li><strong class="font-medium">Crop Health Monitoring:</strong> Drones equipped with special cameras (like multispectral sensors) 
                        can see things the human eye can't. They can identify areas of the field that are stressed, lack nutrients, or are infested 
                        with pests, allowing farmers to intervene before problems get out of hand. </li>
                    <li><strong class="font-medium">Irrigation Management:</strong> By flying over fields, drones can create thermal and visual maps 
                        that show which areas are dry and need water, helping farmers conserve a precious resource. </li>
                    <li><strong class="font-medium">Precision Spraying:</strong> Some drones are designed to carry and apply fertilizers or pesticides. 
                        This allows for targeted application to specific plants or problem areas, reducing waste and minimizing the use of chemicals. </li>
                    
                </ul>
                <p class="mb-4">
                    In modern farming, drones are essential tools for a practice called precision agriculture. Instead of relying on guesswork, 
                    farmers can use drones to collect detailed data about their fields.
                </p>
                <p>
                    This data-driven approach helps farmers optimize their crop yields and operate more efficiently and sustainably.
                </p>
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Challenge: Precision Farming</h2>
                <p class="mb-4">
                    Your mission is to survey different sunflower fields, ensuring that you hit all of the of the required fields.
                </p>
                <p>
                    Your Goal: Guide the drone to each of the designated sunflower squares on the map. Each square will give you one survey point. Once you have 
                    surveyed all spots then land at the target location. Some obstacles you can fly over if they are under 300 feet.
                </p>
            </div>
            
        </div>

        <!-- Column 2: Blockly Workspace -->
        <div class="flex-1 bg-white shadow-lg rounded-xl p-6 flex flex-col items-center justify-center">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Code Your Drone</h2>
            <div id="blocklyContainer" class="w-full">
                <div id="blocklyDiv"></div> <!-- Add blocklyDiv here -->
            </div>
            <div class="flex space-x-4 mt-4">
                <button id="runButton" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                    Run
                </button>
                <button id="resetButton" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded">
                    Reset
                </button>
            </div>
        </div>

        <!-- Column 3: Drone Simulation -->
        <div class="flex-1 bg-white shadow-lg rounded-xl p-6 flex flex-col items-center">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Drone Simulation</h2>
            <!-- Drone media + Altitude/Status side-by-side -->
            <div class="flex items-start w-full max-w-full mb-4 gap-4">
                <div id="droneMediaWrapper" class="rounded-xl shadow-sm">
                    <img src="../images/drone.png" alt="Drone" class="rounded-xl shadow-sm w-[150px] h-[100px]">
                </div>
                <div class="bg-gray-100 rounded-lg p-3 w-full max-w-xs">
                    <div class="flex items-center justify-between">
                        <span class="text-sm font-medium text-gray-600">Altitude:</span>
                        <span id="altitudeDisplay" class="text-lg font-bold text-blue-600">0 units</span>
                    </div>
                    <div class="flex items-center justify-between mt-1">
                        <span class="text-sm font-medium text-gray-600">Status:</span>
                        <span id="flightStatus" class="text-sm font-semibold text-red-600">Landed</span>
                    </div>
                </div>
            </div>

            <!-- Birds-eye view simulation with side gauge -->
            <div id="simulationContainer" class="w-full">
                <div class="flex w-full h-full items-stretch">
                    <div class="flex-1">
                        <canvas id="simulationCanvas" class="rounded-xl border border-gray-300 w-full h-full"></canvas>
                    </div>
                    <div class="w-20 ml-3 rounded-xl border border-gray-200 overflow-hidden">
                        <canvas id="altitudeGauge" class="w-full h-full"></canvas>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Blockly scripts -->
    <script src="https://unpkg.com/blockly@9.0.0/blockly.min.js"></script>

    <!-- JavaScript logic -->
    <script src="../index.js"></script>
    <script src="agriculture.js"></script>

    <script>
    document.getElementById('lessons-button').addEventListener('click', function() {
        document.getElementById('lessons-dropdown').classList.toggle('hidden');
    });

    // Optional: Close the dropdown if the user clicks anywhere else
    document.addEventListener('click', function(event) {
        const dropdown = document.getElementById('lessons-dropdown');
        const button = document.getElementById('lessons-button');

        if (!dropdown.contains(event.target) && !button.contains(event.target)) {
            dropdown.classList.add('hidden');
        }
    });
    document.getElementById('part107-button').addEventListener('click', function() {
        document.getElementById('part107-dropdown').classList.toggle('hidden');
    });

    // Optional: Close the dropdown if the user clicks anywhere else
    document.addEventListener('click', function(event) {
        const dropdown = document.getElementById('part107-dropdown');
        const button = document.getElementById('part107-button');

        if (!dropdown.contains(event.target) && !button.contains(event.target)) {
            dropdown.classList.add('hidden');
        }
    });
    </script>
</body>
</html>
