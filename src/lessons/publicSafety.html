<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Drone Education App</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .blocklyFlyoutScrollbar.blocklyScrollbarVertical {
            display: none;
        }

        /* For WebKit browsers (Chrome, Safari) */
        .blocklyFlyoutScrollbar.blocklyScrollbarVertical::-webkit-scrollbar {
            display: none;
        }
        /* Custom styles to ensure Blockly and canvas fill their containers */
        #blocklyDiv, #simulationCanvas {
            width: 100%;
            height: 100%;
            display: block;
        }
        #blocklyContainer, #simulationContainer {
            height: 60vh; /* Adjust height for better fit */
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            overflow: hidden;
            background-color: #f9fafb;
        }
        /* --- FIX: Create a new stacking context for Blockly --- */
        #blocklyContainer {
            position: relative;
            z-index: 0;
        }
        .scrollable-content {
            height: 100%;
            overflow-y: auto;
        }
        /* Force smaller drone media size */
        #droneMediaWrapper img,
        #droneMediaWrapper video {
            width: 150px !important;
            height: 100px !important;
            object-fit: contain;
            display: block;
        }
        #droneMediaWrapper video {
            margin-bottom: 0 !important;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans p-6">

    <!-- Navigation Menu -->
    <nav class="bg-white shadow-lg rounded-full px-6 py-3 mb-6 flex justify-center space-x-4">
        <a href="../index.html" class="text-gray-700 font-semibold hover:text-blue-600 transition-colors duration-200">Home</a>
        <a href="game/python_game.html" class="text-gray-700 font-semibold hover:text-blue-600 transition-colors duration-200">Game</a>
        <div class="relative">
            <button id="lessons-button" class="text-gray-700 font-semibold hover:text-blue-600 transition-colors duration-200 focus:outline-none">
                Lessons
            </button>
            <div id="lessons-dropdown" class="absolute hidden bg-white shadow-lg rounded-xl p-2 w-48 mt-2 z-10">
                <a href="agriculture.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Agriculture</a>
                <a href="construction.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Construction</a>
                <a href="realEstate.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Real Estate</a>
                <a href="filmMaking.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Filmmaking</a>
                <a href="publicSafety.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Public Safety</a>
                <a href="surveyingMapping.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Surveying and Mapping</a>
                <a href="energyUtilities.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Energy and Utilities</a>
                <a href="logisticsDelivery.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Logistics and Delivery</a>
                <a href="journalism.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Journalism</a>
                <a href="environmentalConservation.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Environmental Conservation</a>
            </div>
        </div>
        <div class="relative">
            <button id="part107-button" class="text-gray-700 font-semibold hover:text-blue-600 transition-colors duration-200 focus:outline-none">
                Part 107 Study Guide
            </button>
            <div id="part107-dropdown" class="absolute hidden bg-white shadow-lg rounded-xl p-2 w-48 mt-2 z-10">
                <a href="/part107/part107.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Introduction</a>
                <a href="/part107/regulations.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Regulations</a>
                <a href="/part107/airspace.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Airspace & Requirements</a>
                <a href="/part107/weather.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Weather</a>
                <a href="/part107/loading.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Loading & Performance</a>
                <a href="/part107/operations.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg">Operations</a>
            </div>
        </div>
    </nav>

    <!-- Main container for the 3-column layout -->
    <div class="flex flex-col lg:flex-row gap-6">

        <!-- Column 1: Drone Information -->
        <div class="flex-1 bg-white shadow-lg rounded-xl p-6 max-h-[80vh] flex flex-col">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">The Role of Drones in Public Safety</h2>
            <div class="h-full overflow-y-auto">
                <p class="mb-4">
                    Drones are increasingly used in public safety to enhance the effectiveness and safety of law enforcement and fire departments.
                </p>

                <h3 class="text-2xl font-bold text-gray-800 mb-4">How Drones Help</h3>
                <ul class="list-disc list-inside space-y-1 mb-4">
                    <li><strong class="font-medium">Search and Rescue: </strong> 
                        Drones with thermal cameras and high-resolution imaging can quickly scan large or difficult-to-access areas to locate missing persons, especially at night 
                        or in dense forests. They are also invaluable in disaster situations like earthquakes and floods to find trapped survivors.</li>

                    <li><strong class="font-medium">Firefighting: </strong> For fire departments, drones provide real-time aerial surveillance of a fire's perimeter, helping to 
                        identify hotspots invisible to the naked eye. This allows for better resource allocation and minimizes risks to firefighters. Some drones can even be equipped 
                        with foam dispensers or water cannons for initial fire suppression.</li>

                    <li><strong class="font-medium">Situational Awareness: </strong> Drones offer a "bird's-eye view" of an incident, such as an active shooter situation, hostage crisis, 
                        or car chase. This real-time intelligence allows first responders to make more informed decisions before entering a dangerous scene.</li>

                    <li><strong class="font-medium">Accident and Crime Scene Reconstruction: </strong> Drones can quickly and accurately capture hundreds of photos from various angles 
                        to create detailed 3D models of accident or crime scenes. This speeds up the process of clearing the area while providing comprehensive evidence for later analysis 
                        and legal proceedings.</li>

                    <li><strong class="font-medium">Crowd and Traffic Monitoring: </strong> At large public events, protests, or during major traffic incidents, drones can monitor crowd 
                        movements, identify potential disturbances, and direct officers to areas of congestion.</li>

                <h3 class="text-2xl font-bold text-gray-800 mb-4">Ethical Considerations and Challenges</h3>
                <p>While the benefits are significant, the use of drones in public safety also raises important ethical and legal concerns:</p>
                <ul class="list-disc list-inside space-y-1 mb-4">
                    <li><strong class="font-medium">Privacy: </strong> 
                        The use of drones for surveillance, especially in public areas, raises questions about individual privacy and the potential for a "big brother" atmosphere. There 
                        is a need for clear policies on how data is collected, stored, and used.</li>

                    <li><strong class="font-medium">Public Trust: </strong> To ensure public acceptance, law enforcement agencies must be transparent about their drone programs, including 
                        their purpose and limitations, and engage with the community to build trust.</li>
                    
                    <li><strong class="font-medium">Legal Frameworks: </strong> The legal landscape for drone use is still evolving, with ongoing debates about regulations that balance 
                        public safety with civil liberties.</li>
                </ul>
                <h3 class="text-2xl font-bold text-gray-800 mb-4">Examples of Drones Used in Public Safety</h3>
                <p>Public safety agencies often use multi-rotor drones that are capable of vertical takeoff and landing (VTOL) and can hover in place. Examples include models from manufacturers 
                    like DJI and Autel, such as the DJI Matrice 30T and Autel EVO Max 4T, which are known for their long flight times, durable design, and advanced camera systems (including thermal 
                    and zoom lenses) that are essential for emergency response.</p>

                
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Challenge: Search and Rescue</h2>
                <p class="mb-4">
                    Your mission is to find the missing hiker and report the hiker's location to command.
                </p>
                <p>
                    Your Goal: Guide the drones to the hiker's location. Then avoid all the obstacles and make it to the landing zone. The hiker's location will give you one survey point. Once you have 
                    surveyed all spots then land at the target location. Some obstacles you can fly over if they are under 300 feet.
                </p>
            </div>
            
        </div>

        <!-- Column 2: Blockly Workspace -->
        <div class="flex-1 bg-white shadow-lg rounded-xl p-6 flex flex-col items-center justify-center">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Code Your Drone</h2>
            <div id="blocklyContainer" class="w-full">
                <div id="blocklyDiv"></div> <!-- Add blocklyDiv here -->
            </div>
            <div class="flex space-x-4 mt-4">
                <button id="runButton" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                    Run
                </button>
                <button id="resetButton" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded">
                    Reset
                </button>
            </div>
        </div>

        <!-- Column 3: Drone Simulation -->
        <div class="flex-1 bg-white shadow-lg rounded-xl p-6 flex flex-col items-center">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Drone Simulation</h2>
            <!-- Drone media + Altitude/Status side-by-side -->
            <div class="flex items-start w-full max-w-full mb-4 gap-4">
                <div id="droneMediaWrapper" class="rounded-xl shadow-sm">
                    <img src="../images/drone.png" alt="Drone" class="rounded-xl shadow-sm w-[150px] h-[100px]">
                </div>
                <div class="bg-gray-100 rounded-lg p-3 w-full max-w-xs">
                    <div class="flex items-center justify-between">
                        <span class="text-sm font-medium text-gray-600">Altitude:</span>
                        <span id="altitudeDisplay" class="text-lg font-bold text-blue-600">0 units</span>
                    </div>
                    <div class="flex items-center justify-between mt-1">
                        <span class="text-sm font-medium text-gray-600">Status:</span>
                        <span id="flightStatus" class="text-sm font-semibold text-red-600">Landed</span>
                    </div>
                </div>
            </div>

            <!-- Birds-eye view simulation with side gauge -->
            <div id="simulationContainer" class="w-full">
                <div class="flex w-full h-full items-stretch">
                    <div class="flex-1">
                        <canvas id="simulationCanvas" class="rounded-xl border border-gray-300 w-full h-full"></canvas>
                    </div>
                    <div class="w-20 ml-3 rounded-xl border border-gray-200 overflow-hidden">
                        <canvas id="altitudeGauge" class="w-full h-full"></canvas>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Blockly scripts -->
    <script src="https://unpkg.com/blockly@9.0.0/blockly.min.js"></script>

    <!-- JavaScript logic -->
    <script src="../index.js"></script>
    <script src="publicSafety.js"></script>

    <script>
    document.getElementById('lessons-button').addEventListener('click', function() {
        document.getElementById('lessons-dropdown').classList.toggle('hidden');
    });

    // Optional: Close the dropdown if the user clicks anywhere else
    document.addEventListener('click', function(event) {
        const dropdown = document.getElementById('lessons-dropdown');
        const button = document.getElementById('lessons-button');

        if (!dropdown.contains(event.target) && !button.contains(event.target)) {
            dropdown.classList.add('hidden');
        }
    });
    </script>
</body>
</html>
